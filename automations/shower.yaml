- id: '1230123123'
  alias: Shower is on
  max_exceeded: silent
  trigger:
    - platform: numeric_state
      entity_id: sensor.shower_sensor_humidity
      above: 82
  condition:
    - condition: or
      conditions:
        - condition: state
          entity_id: media_player.bathroom_speaker
          state: 'idle'
        - condition: state
          entity_id: media_player.bathroom_speaker
          state: 'off'
        - condition: state
          entity_id: media_player.bathroom_speaker
          state: 'paused'
  action:
    - service: media_player.select_source
      data:
        source: bathroom_speaker
        entity_id: media_player.ytube_music_player
    - service: media_player.play_media
      data:
        entity_id: media_player.ytube_music_player
        media_content_id: >
          {% if is_state('input_text.mode', 'morning') %}
            RDQMlnrNu4KErZI
          {% elif is_state('input_text.mode', 'day') %}
            RDTMAK5uy_nTsa0Irmcu2li2-qHBoZxtrpG9HuC3k_Q
          {% elif is_state('input_text.mode', 'evening') %}
            RDTMAK5uy_nzfwl2UYv7htL7wDoxbX8Pp6UAFBd92cQ
          {% else %}
            RDTMAK5uy_nzfwl2UYv7htL7wDoxbX8Pp6UAFBd92cQ
          {% endif %}
        media_content_type: >
          {% if is_state('input_text.mode', 'morning') %}
            radio
          {% elif is_state('input_text.mode', 'day') %}
            playlist
          {% elif is_state('input_text.mode', 'evening') %}
            playlist
          {% else %}
            playlist
          {% endif %}
    - wait_template: "{{ states('sensor.shower_sensor_humidity') | int < 80 }}"
    - service: media_player.media_stop
      data:
        entity_id: media_player.bathroom_speaker